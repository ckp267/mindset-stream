<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="./apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="./favicon-32x32.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="./favicon-16x16.png"
        />
        <link rel="manifest" href="./site.webmanifest" />
        <title>Mindset Stream</title>
        <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
        <style>
            :root {
                --bg-color: #4a4a4d; /* Dark grey from screenshot */
                --text-color: #899390; /* Updated text color */
                --border-color: #fff;
                --menu-bg-color: #00afc0;
                --menu-text-color: #fff;
                --video-bg-color: #000;
                --overlay-bg-color: rgba(0, 0, 0, 0.5);
                --shadow-color: rgba(0, 0, 0, 0.2);

                --content-max-width: 1200px; /* Max width for the main content column */
                --base-padding: clamp(15px, 4vw, 30px); /* Responsive padding */
                --logo-height: clamp(
                    45px,
                    7vh,
                    65px
                ); /* Responsive logo height */
                --footer-font-size: clamp(
                    10px,
                    1.5vh,
                    12px
                ); /* Responsive footer font */
                --menu-width: 300px; /* Width of the sliding menu */
            }

            @font-face {
                font-family: 'DIN Medium';
                font-style: normal;
                font-weight: 400;
                src: url('fonts/DIN-Medium-Regular.ttf');
            }

            body {
                margin: 0;
                font-family: 'DIN Medium', Arial, Helvetica, sans-serif;
                background-color: var(--bg-color);
                color: var(--text-color);
                line-height: 1.6;
                /* Ensure body itself doesn't cause overflow if page-container is full width */
                overflow-x: hidden;
            }

            .page-container {
                min-height: 100vh;
                display: flex;
                flex-direction: column;
                position: relative;
                padding: var(--base-padding);
                box-sizing: border-box;
                width: 100%; /* Ensure page-container takes full viewport width */
            }

            .content-wrapper {
                width: 100%;
                max-width: var(--content-max-width);
                margin: 0 auto;
                display: flex;
                flex-direction: column;
                flex-grow: 1;
                z-index: 1;
                position: relative; /* Added for stacking context if needed */
            }

            .logo-container {
                flex: 1;
                display: flex;
                align-items: center;
            }

            .logo {
                height: var(--logo-height);
                width: auto;
                display: block;
            }

            .menu-icon-container {
                flex: 0 0 auto;
                display: flex;
                align-items: center;
            }

            .menu-icon {
                height: calc(var(--logo-height) * 0.5);
                width: auto;
                cursor: pointer;
                transition: transform 0.3s ease;
            }

            .menu-icon:hover {
                transform: scale(1.1);
            }

            main {
                flex-grow: 1;
                display: flex;
                justify-content: center;
                align-items: center;
                width: 100%; /* Ensure main takes up available width in content-wrapper */
                /* Add some vertical spacing */
                margin-top: clamp(15px, 3vh, 30px);
                margin-bottom: clamp(15px, 3vh, 30px);
            }

            /* Video Player Styles - integrated and adjusted */
            .video-container {
                width: 100%;
                /* Set a max-width for the video container itself, 
                  e.g., 90% of its parent (main) to leave some background visible,
                  or a fixed pixel value like in the original PSD.
                  This will help make it feel more like the PSD's black frame. */
                max-width: 85%; /* Adjust as needed, e.g. 800px, 900px etc. */
                margin-left: auto; /* Center the video container if max-width is less than 100% */
                margin-right: auto; /* Center the video container */

                aspect-ratio: 16 / 9; /* JS will try to update this */
                background: var(--video-bg-color);
                position: relative;

                /* Add a max-height based on viewport height to prevent it from being too tall on mobile */
                max-height: 75vh; /* 75% of the viewport height */
                overflow: hidden; /* Ensure video doesn't spill out if aspect ratios mismatch badly */
            }

            .video-container video {
                width: 100%;
                height: 100%;
                object-fit: contain; /* Letterboxes if aspect ratio mismatch */
                display: none; /* Unhidden by script when ready */
                /* The video itself should fill the container, but max-height on container will limit it */
            }
            /* End Video Player Styles */

            footer {
                display: flex;
                justify-content: space-between;
                align-items: center; /* Vertically center align items */
                padding-top: var(--base-padding);
                font-size: var(--footer-font-size);
                flex-wrap: wrap; /* Allow items to wrap on smaller screens */
                gap: 10px; /* Reduced gap slightly */
                border-top: 2px solid var(--border-color); /* Use new text color with alpha for border */
                /* Text alignment for children will be default (left) */
            }

            .footer-left,
            .footer-right {
                flex-basis: auto; /* Allow natural sizing */
                /* On smaller screens when they stack, make them full width */
            }
            /* Responsive Adjustments */
            @media (max-width: 1024px) {
                /* Tablets */
                .video-container {
                    max-width: 90%;
                    max-height: 70vh;
                }
            }

            @media (max-width: 768px) {
                /* Mobile */
                :root {
                    /* Further increase logo base size on mobile if still too small */
                    --logo-height: clamp(50px, 8vh, 60px);
                }
                .video-container {
                    max-width: 100%; /* Video can take more width on mobile */
                    max-height: 60vh; /* Reduce max height further on mobile */
                }
                footer {
                    flex-direction: column;
                    align-items: flex-start; /* Align text to the left for stacked items */
                    gap: 5px; /* Smaller gap for stacked footer items */
                }
                .footer-left,
                .footer-right {
                    width: 100%; /* Make footer text blocks take full width when stacked */
                    text-align: center; /* Center footer text on mobile */
                }
            }

            @media (max-width: 480px) {
                /* Small Mobile */
                :root {
                    --logo-height: clamp(45px, 7vh, 55px);
                }
                .video-container {
                    max-height: 50vh;
                }
                .footer-left,
                .footer-right {
                    font-size: 0.9em; /* Slightly smaller font for footer on tiny screens */
                }
            }

            /* Sliding Menu Styles */
            .sliding-menu {
                position: fixed;
                top: 0;
                right: -100%; /* Start fully off-screen */
                width: var(--menu-width);
                height: 100vh;
                background-color: var(--menu-bg-color);
                transition: right 0.3s ease;
                z-index: 1000;
                box-shadow: -2px 0 10px var(--shadow-color);
                color: var(--menu-text-color);
                padding: var(--base-padding);
            }

            .sliding-menu a {
                color: var(--menu-text-color);
                text-decoration: none;
                display: block;
                padding: 15px 0;
                font-size: 1.2em;
            }

            .sliding-menu a:hover {
                opacity: 0.8;
            }

            .sliding-menu.open {
                right: 0;
            }

            .menu-overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: var(--overlay-bg-color);
                display: none;
                z-index: 999;
            }

            .menu-overlay.open {
                display: block;
            }

            header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                width: 100%;
                position: relative;
                border-bottom: 2px solid var(--border-color);
                padding-bottom: var(--base-padding);
            }
        </style>
    </head>
    <body>
        <div class="page-container">
            <div class="content-wrapper">
                <header>
                    <div class="logo-container">
                        <img
                            src="MindSet-Logo.svg"
                            alt="Mindset Logo"
                            class="logo"
                        />
                    </div>
                    <div class="menu-icon-container">
                        <img
                            src="Menu-icon.svg"
                            alt="Menu"
                            class="menu-icon"
                            id="menuIcon"
                        />
                    </div>
                </header>

                <!-- Sliding Menu -->
                <div class="sliding-menu" id="slidingMenu">
                    <!-- Menu content will go here -->
                </div>
                <div class="menu-overlay" id="menuOverlay"></div>

                <main>
                    <div class="video-container">
                        <video id="video" controls playsinline></video>
                    </div>
                </main>

                <footer>
                    <div class="footer-left">
                        MINDSET NETWORK NPC IS A REGISTERED NOT-FOR-PROFIT
                    </div>
                    <div class="footer-right">
                        Reg Number: 2002 / 003517 / 08 - South Africa
                    </div>
                </footer>
            </div>
        </div>

        <script>
            const video = document.getElementById('video');
            const container = video.parentElement; // This is .video-container
            const url =
                'https://globecast.live/Mindset/index.m3u8?token=odr9Nx6RlSVDy0';

            if (Hls.isSupported()) {
                const hls = new Hls();
                hls.loadSource(url);
                hls.attachMedia(video);

                hls.on(Hls.Events.MANIFEST_PARSED, (_evt, data) => {
                    console.log('🔍 hls.levels →', hls.levels);
                    // The 'level' object might not have width/height directly at data.startLevel
                    // It's better to access width/height from hls.levels[levelIdx]
                    const levelIdx =
                        data.startLevel !== undefined
                            ? data.startLevel
                            : hls.levels.length > 0
                            ? 0
                            : -1;

                    if (levelIdx !== -1 && hls.levels[levelIdx]) {
                        const { width, height } = hls.levels[levelIdx];
                        if (width && height) {
                            container.style.aspectRatio = `${width} / ${height}`;
                        }
                    }
                    video.style.display = 'block';
                    video.play().catch((error) => {
                        console.log('Video autoplay prevented:', error);
                        // Autoplay might be blocked, user interaction might be needed.
                    });
                });

                hls.on(Hls.Events.LEVEL_SWITCHED, (_evt, data) => {
                    const { level } = data; // level is an index
                    if (hls.levels[level]) {
                        const { width, height } = hls.levels[level];
                        if (width && height) {
                            container.style.aspectRatio = `${width} / ${height}`;
                        }
                    }
                });
            } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                // Native HLS (Safari)
                video.src = url;
                video.addEventListener('loadedmetadata', () => {
                    const w = video.videoWidth;
                    const h = video.videoHeight;
                    if (w && h) {
                        // Ensure w and h are valid before setting aspect ratio
                        container.style.aspectRatio = `${w} / ${h}`;
                    }
                    video.style.display = 'block';
                    video.play().catch((error) => {
                        console.log(
                            'Video autoplay prevented (Safari):',
                            error
                        );
                    });
                });
                video.addEventListener('canplay', () => {
                    // Ensure video is ready before trying to play
                    video.style.display = 'block';
                    // video.play().catch(() => {}); // Autoplay can be attempted here too
                });
            } else {
                console.error('HLS not supported in this browser');
                container.innerHTML =
                    '<p style="color: white; padding: 20px;">Sorry, HLS video playback is not supported in your browser.</p>';
            }

            // Menu functionality
            const menuIcon = document.getElementById('menuIcon');
            const slidingMenu = document.getElementById('slidingMenu');
            const menuOverlay = document.getElementById('menuOverlay');

            menuIcon.addEventListener('click', toggleMenu);
            menuOverlay.addEventListener('click', toggleMenu);

            function toggleMenu() {
                slidingMenu.classList.toggle('open');
                menuOverlay.classList.toggle('open');
            }

            // Close menu when pressing Escape key
            document.addEventListener('keydown', (e) => {
                if (
                    e.key === 'Escape' &&
                    slidingMenu.classList.contains('open')
                ) {
                    toggleMenu();
                }
            });
        </script>
    </body>
</html>
