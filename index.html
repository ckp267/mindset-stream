<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mindset Stream</title>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <style>
    :root {
      --bg-color: #4A4A4D; /* Dark grey from screenshot */
      --text-color: #E0E0E0; /* Light grey for text */
      --content-max-width: 1200px; /* Max width for the main content column */
      --base-padding: clamp(15px, 3vw, 30px); /* Responsive padding */
      --logo-height: clamp(40px, 5vh, 50px); /* Responsive logo height */
      --footer-font-size: clamp(10px, 1.5vh, 12px); /* Responsive footer font */
    }

    body {
      margin: 0;
      font-family: Arial, Helvetica, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.6;
      /* Ensure body itself doesn't cause overflow if page-container is full width */
      overflow-x: hidden;
    }

    .page-container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      position: relative;
      padding: var(--base-padding);
      box-sizing: border-box;
      /* overflow-x: hidden; /* Already on body, but can keep here too if desired */
      width: 100%; /* Ensure page-container takes full viewport width */
    }

    .content-wrapper {
      width: 100%;
      max-width: var(--content-max-width);
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      flex-grow: 1;
      z-index: 1;
      position: relative; /* Added for stacking context if needed */
    }

    header {
      padding-bottom: var(--base-padding);
    }

    .logo {
      height: var(--logo-height);
      width: auto;
    }

    main {
      flex-grow: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%; /* Ensure main takes up available width in content-wrapper */
    }

    /* Video Player Styles - integrated and adjusted */
    .video-container {
      width: 100%;
      /* max-width: 800px; */ /* Keep commented or adjust if needed */
      aspect-ratio: 16 / 9;
      background: black;
      position: relative;
      margin-top: clamp(10px, 2vh, 20px); /* Responsive margin */
      margin-bottom: clamp(10px, 2vh, 20px); /* Responsive margin */
      /* Ensure it doesn't push out of the content-wrapper unexpectedly */
      max-width: 100%; 
    }

    .video-container video {
      width: 100%;
      height: 100%;
      object-fit: contain; /* Letterboxes if aspect ratio mismatch */
      display: none;       /* Unhidden by script when ready */
    }
    /* End Video Player Styles */

    footer {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-top: var(--base-padding);
      font-size: var(--footer-font-size);
      flex-wrap: wrap; /* Allow items to wrap on smaller screens */
      gap: 10px; /* Space between items if they wrap */
      border-top: 1px solid rgba(255, 255, 255, 0.1); /* Optional subtle separator */
    }

    .footer-left, .footer-right {
      flex-basis: auto; /* Allow natural sizing */
    }

    .decorative-shapes-container {
      position: absolute;
      right: 0; /* Align to the very right edge of page-container */
      top: 50%;
      transform: translateY(-50%);
      
      /* Adjust width constraints */
      width: clamp(100px, 20vw, 250px); /* Control width more directly */
      max-width: 30%; /* Max 30% of the parent's width (page-container) */
      height: auto;   /* Let height adjust based on the image's aspect ratio and new width */
      
      /* SVG max height to prevent it from becoming too tall on certain aspect ratios */
      max-height: clamp(200px, 35vh, 346.44px); 
      z-index: 0;
    }

    .decorative-shapes-container img {
      width: 100%; /* Make image fill the new width of the container */
      height: 100%; /* Make image fill the new height of the container */
      object-fit: contain; /* Ensure aspect ratio is maintained within container bounds */
      display: block;
    }

    /* Responsive Adjustments */
    @media (max-width: 1024px) { /* Tablets */
      /* :root values will now use clamp, specific overrides might not be as necessary */
      /* but can be kept for finer control */
      .decorative-shapes-container {
        width: clamp(80px, 18vw, 200px);
        opacity: 0.8;
        /* right: 10px; /* no longer needed if right:0 on page-container */
      }
    }

    @media (max-width: 768px) { /* Mobile */
      .content-wrapper {
        padding-left: 5px; /* Add slight padding if content touches edges */
        padding-right: 5px;
      }
      footer {
        flex-direction: column;
        align-items: flex-start;
      }
      .decorative-shapes-container {
        width: clamp(60px, 15vw, 150px);
        opacity: 0.6;
        /* right: 5px; /* no longer needed */
      }
    }

    @media (max-width: 480px) { /* Small Mobile */
      .decorative-shapes-container {
        display: none;
      }
    }

  </style>
</head>
<body>
  <div class="page-container">
    <div class="content-wrapper">
      <header>
        <img src="MindSet-Logo.svg" alt="Mindset Logo" class="logo">
      </header>

      <main>
        <div class="video-container">
          <video id="video" controls playsinline></video>
        </div>
      </main>

      <footer>
        <div class="footer-left">MINDSET NETWORK NPC IS A REGISTERED NOT-FOR-PROFIT</div>
        <div class="footer-right">Reg Number: 2002 / 003517 / 08 - South Africa</div>
      </footer>
    </div>

    <div class="decorative-shapes-container">
      <img src="Shape-Green.svg" alt="Decorative Green Shapes">
    </div>
  </div>

  <script>
    const video     = document.getElementById('video');
    const container = video.parentElement; // This is .video-container
    const url       = 'https://globecast.live/Mindset/index.m3u8?token=odr9Nx6RlSVDy0';

    if (Hls.isSupported()) {
      const hls = new Hls();
      hls.loadSource(url);
      hls.attachMedia(video);

      hls.on(Hls.Events.MANIFEST_PARSED, (_evt, data) => {
        console.log('🔍 hls.levels →', hls.levels);
        // The 'level' object might not have width/height directly at data.startLevel
        // It's better to access width/height from hls.levels[levelIdx]
        const levelIdx = data.startLevel !== undefined ? data.startLevel : (hls.levels.length > 0 ? 0 : -1) ;

        if (levelIdx !== -1 && hls.levels[levelIdx]) {
            const { width, height } = hls.levels[levelIdx];
            if (width && height) {
                container.style.aspectRatio = `${width} / ${height}`;
            }
        }
        video.style.display = 'block';
        video.play().catch((error) => {
            console.log('Video autoplay prevented:', error);
            // Autoplay might be blocked, user interaction might be needed.
        });
      });

      hls.on(Hls.Events.LEVEL_SWITCHED, (_evt, data) => {
        const { level } = data; // level is an index
        if (hls.levels[level]) {
            const { width, height } = hls.levels[level];
            if (width && height) {
                container.style.aspectRatio = `${width} / ${height}`;
            }
        }
      });

    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
      // Native HLS (Safari)
      video.src = url;
      video.addEventListener('loadedmetadata', () => {
        const w = video.videoWidth;
        const h = video.videoHeight;
        if (w && h) { // Ensure w and h are valid before setting aspect ratio
            container.style.aspectRatio = `${w} / ${h}`;
        }
        video.style.display = 'block';
         video.play().catch((error) => {
            console.log('Video autoplay prevented (Safari):', error);
        });
      });
       video.addEventListener('canplay', () => { // Ensure video is ready before trying to play
        video.style.display = 'block';
        // video.play().catch(() => {}); // Autoplay can be attempted here too
      });
    } else {
      console.error('HLS not supported in this browser');
      container.innerHTML = '<p style="color: white; padding: 20px;">Sorry, HLS video playback is not supported in your browser.</p>';
    }
  </script>
</body>
</html>
